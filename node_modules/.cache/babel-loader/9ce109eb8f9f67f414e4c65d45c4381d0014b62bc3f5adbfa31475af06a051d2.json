{"ast":null,"code":"import React,{useCallback,useEffect,useRef}from\"react\";import{useDispatch}from\"react-redux\";import{fetchVASData}from\"../../APIIntegrations/VASummary\";import{setAccessToken,setEventHandlerUrl}from\"../../Utils/SessionVariables\";import EnvironmentComponent from\"../../Utils/ResolveEnvironment\";import AssistantPanel from\"../AssistantPanel/AssistantPanel\";import{jsx as _jsx}from\"react/jsx-runtime\";const VirtualAssistant=props=>{const apiBaseURL=useRef(\"\");const servingURL=useRef(\"\");const websocketRegisterUrl=useRef(\"\");// #region Redux Store\nconst dispatch=useDispatch();// Get the dispatch function from the Redux store\n//#endregion\nconst handleCreateGRPCChannel=useCallback(()=>{const host=servingURL.current;// The URL for the gRPC service\nconst authToken=props.accessToken;const orgId=props.orgId;const interactionId=props.interactionId;console.info(\"Started Fetching VAH Data\",host,interactionId,orgId,authToken);// Dispatch the thunk action to fetch the VAH data\ndispatch(fetchVASData({host,authToken,interactionId,orgId}));},[dispatch,props.accessToken,props.orgId,props.interactionId]);//#region Desktop Integration\nconst RequestSummary=()=>{console.info(\"Requesting the VA Summary., Interaction ID: \",props.interactionId);// if interaction id present get vah data\nif(props.interactionId&&props.interactionId!==null){handleCreateGRPCChannel();}else{console.info(\"Requesting the VA Summary is stopped, due to empty Interaction ID\");}};const init=splitKey=>{//#region Feature Flag Check\nconsole.info(\"Skipping Initializing/Validating the Split IO SDK\");RequestSummary();return true;};useEffect(()=>{console.info(\"Starts here ..\");//resolve the environment\nconst envValues=EnvironmentComponent(props.env);if(envValues.apiBaseEndpoint!==\"\"){apiBaseURL.current=envValues.apiBaseEndpoint;servingURL.current=envValues.servingUrl;websocketRegisterUrl.current=envValues.notifsDataRegistrationUrl;console.info(\"API Base url \",apiBaseURL.current);dispatch(setAccessToken(props.accessToken));dispatch(setEventHandlerUrl(envValues.eventHandlerUrl));setTimeout(()=>{console.info(\"Start the Initializing Split IO SDK\");init(envValues.splitKeyToken);},1000);}},[props.accessToken,props.orgId,props.interactionId,props.env]);return/*#__PURE__*/_jsx(\"div\",{className:\"virtual-assistance-summary\",children:/*#__PURE__*/_jsx(AssistantPanel,{})});};export default VirtualAssistant;","map":{"version":3,"names":["React","useCallback","useEffect","useRef","useDispatch","fetchVASData","setAccessToken","setEventHandlerUrl","EnvironmentComponent","AssistantPanel","jsx","_jsx","VirtualAssistant","props","apiBaseURL","servingURL","websocketRegisterUrl","dispatch","handleCreateGRPCChannel","host","current","authToken","accessToken","orgId","interactionId","console","info","RequestSummary","init","splitKey","envValues","env","apiBaseEndpoint","servingUrl","notifsDataRegistrationUrl","eventHandlerUrl","setTimeout","splitKeyToken","className","children"],"sources":["/Users/ratbalas/Documents/Projects/temp/ai-assistant.github.io/src/components/VirtualAssistant/index.tsx"],"sourcesContent":["import React, { FC, useCallback, useEffect, useRef } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { fetchVASData } from \"../../APIIntegrations/VASummary\";\nimport { setAccessToken, setEventHandlerUrl } from \"../../Utils/SessionVariables\";\nimport EnvironmentComponent from \"../../Utils/ResolveEnvironment\";\nimport AssistantPanel from \"../AssistantPanel/AssistantPanel\";\n\ninterface IProps {\n  env: string;\n  orgId: string;\n  accessToken: string;\n  interactionId: string;\n}\n\nconst VirtualAssistant: FC<IProps> = (props) => {\n  const apiBaseURL = useRef<string>(\"\");\n  const servingURL = useRef<string>(\"\");\n  const websocketRegisterUrl = useRef<string>(\"\");\n\n  // #region Redux Store\n  const dispatch = useDispatch(); // Get the dispatch function from the Redux store\n  //#endregion\n\n\n  const handleCreateGRPCChannel = useCallback(() => {\n    const host = servingURL.current; // The URL for the gRPC service\n    const authToken = props.accessToken;\n    const orgId = props.orgId;\n    const interactionId = props.interactionId;\n    console.info(\"Started Fetching VAH Data\", host, interactionId, orgId, authToken);\n    // Dispatch the thunk action to fetch the VAH data\n    dispatch(fetchVASData({ host, authToken, interactionId, orgId }));\n  }, [dispatch, props.accessToken, props.orgId, props.interactionId]);\n\n  //#region Desktop Integration\n  const RequestSummary = (): any => {\n    console.info(\"Requesting the VA Summary., Interaction ID: \", props.interactionId);\n\n    // if interaction id present get vah data\n    if (props.interactionId && props.interactionId !== null) {\n      handleCreateGRPCChannel();\n    } else {\n      console.info(\"Requesting the VA Summary is stopped, due to empty Interaction ID\");\n    }\n  };\n\n  const init = (splitKey: string) => {\n    //#region Feature Flag Check\n    console.info(\"Skipping Initializing/Validating the Split IO SDK\");\n    RequestSummary();\n    return true;\n  };\n\n  useEffect(() => {\n    console.info(\"Starts here ..\");\n    //resolve the environment\n    const envValues = EnvironmentComponent(props.env);\n\n    if (envValues.apiBaseEndpoint !== \"\") {\n      apiBaseURL.current = envValues.apiBaseEndpoint;\n      servingURL.current = envValues.servingUrl;\n      websocketRegisterUrl.current = envValues.notifsDataRegistrationUrl;\n\n      console.info(\"API Base url \", apiBaseURL.current);\n      dispatch(setAccessToken(props.accessToken));\n      dispatch(setEventHandlerUrl(envValues.eventHandlerUrl));\n\n      setTimeout(() => {\n        console.info(\"Start the Initializing Split IO SDK\");\n        init(envValues.splitKeyToken);\n      }, 1000);\n    }\n  }, [props.accessToken, props.orgId, props.interactionId, props.env]);\n\n  return (\n      <div className=\"virtual-assistance-summary\">\n        <AssistantPanel />\n      </div>\n  );\n};\n\nexport default VirtualAssistant;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}